import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{q as w,p as K,n as g,s as P,r as n,g as F,o as x,h as k,e as l,w as t,l as _,F as $,i as Q,d as R,y as X,E as Z,z as D}from"./index-D9WxJwGC.js";const ee={class:"user-header"},le={class:"table"},te={class:"button-container"},ae={__name:"User",setup(oe){const C=w([]),{proxy:d}=K(),c=async()=>{let r=await d.$api.getUserData(f);C.value=r.list.map(e=>({...e,sexLabel:e.sex===1?"男":"女"})),f.total=r.count},q=g([{prop:"name",label:"姓名"},{prop:"age",label:"年龄"},{prop:"sexLabel",label:"性别"},{prop:"birth",label:"出生日期",width:200},{prop:"addr",label:"地址",width:200}]),y=g({keyWord:""}),f=g({name:"",total:0,page:1}),B=()=>{f.name=y.keyWord,c()},E=r=>{f.page=r,c()},M=r=>{Z.confirm("你确定要删除吗").then(async()=>{await d.$api.deleteUser({id:r.id}),D({showClose:!0,message:"删除成功",type:"success"}),c()})},v=w("add"),i=w(),o=g({sex:"1"}),z=g({name:[{required:!0,message:"姓名是必填项",trigger:"blur"}],age:[{required:!0,message:"年龄是必填项",trigger:"blur"},{type:"number",message:"年龄必须是数字"}],sex:[{required:!0,message:"性别是必选项",trigger:"change"}],birth:[{required:!0,message:"出生日期是必选项"}],addr:[{required:!0,message:"地址是必填项"}]}),L=()=>{i.value=!1,d.$refs.userForm.resetFields()},W=()=>{i.value=!1,d.$refs.userForm.resetFields()},I=()=>{i.value=!0,v.value="add"},N=e=>{var e=new Date(e),u=e.getFullYear(),p=e.getMonth()+1,s=e.getDate();function b(m){return m<10?"0"+m:m}return u+"-"+b(p)+"-"+b(s)},S=()=>{d.$refs.userForm.validate(async r=>{if(r){let e=null;o.birth=/^\d{4}-\d{2}-\d{2}$/.test(o.birth)?o.birth:N(o.birth),v.value=="add"?e=await d.$api.addUser(o):e=await d.$api.editUser(o),e&&(i.value=!1,d.$refs.userForm.resetFields(),c())}else D({showClose:!0,message:"请输入正确的内容",type:"error"})})},j=r=>{v.value="edit",i.value=!0,X(()=>{const e={...r,sex:r.sex.toString()};Object.assign(o,e)})};return P(()=>{c()}),(r,e)=>{const u=n("el-button"),p=n("el-input"),s=n("el-form-item"),b=n("el-form"),m=n("el-table-column"),O=n("el-table"),T=n("el-pagination"),V=n("el-col"),h=n("el-row"),U=n("el-option"),A=n("el-select"),Y=n("el-date-picker"),G=n("el-dialog");return x(),F($,null,[k("div",ee,[l(u,{type:"primary",onClick:I},{default:t(()=>e[7]||(e[7]=[_("新增")])),_:1,__:[7]}),l(b,{inline:"true",model:y},{default:t(()=>[l(s,{label:"请输入"},{default:t(()=>[l(p,{placeholder:"请输入用户名",modelValue:y.keyWord,"onUpdate:modelValue":e[0]||(e[0]=a=>y.keyWord=a)},null,8,["modelValue"])]),_:1}),l(s,null,{default:t(()=>[l(u,{type:"primary",onClick:B},{default:t(()=>e[8]||(e[8]=[_("搜索")])),_:1,__:[8]})]),_:1})]),_:1},8,["model"])]),k("div",le,[l(O,{data:C.value,style:{width:"100%"}},{default:t(()=>[(x(!0),F($,null,Q(q,a=>(x(),R(m,{key:a.prop,width:a.width?a.width:"125",prop:a.prop,label:a.label},null,8,["width","prop","label"]))),128)),l(m,{fixed:"right",label:"Operations",width:"120"},{default:t(a=>[k("div",te,[l(u,{type:"primary",size:"small",onClick:H=>j(a.row)},{default:t(()=>e[9]||(e[9]=[_(" 编辑")])),_:2,__:[9]},1032,["onClick"]),l(u,{type:"danger",size:"small",onClick:H=>M(a.row)},{default:t(()=>e[10]||(e[10]=[_("删除")])),_:2,__:[10]},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),l(T,{class:"pager",background:"",layout:"prev, pager, next",size:"small",total:f.total,onCurrentChange:E},null,8,["total"])]),l(G,{modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=a=>i.value=a),title:v.value=="add"?"新增用户":"编辑用户",width:"35%","before-close":L},{default:t(()=>[l(b,{inline:!0,model:o,rules:z,ref:"userForm"},{default:t(()=>[l(h,null,{default:t(()=>[l(V,{span:12},{default:t(()=>[l(s,{label:"姓名",prop:"name"},{default:t(()=>[l(p,{modelValue:o.name,"onUpdate:modelValue":e[1]||(e[1]=a=>o.name=a),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),l(V,{span:12},{default:t(()=>[l(s,{label:"年龄",prop:"age"},{default:t(()=>[l(p,{modelValue:o.age,"onUpdate:modelValue":e[2]||(e[2]=a=>o.age=a),modelModifiers:{number:!0},placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(h,null,{default:t(()=>[l(V,{span:12},{default:t(()=>[l(s,{class:"select-clearn",label:"性别",prop:"sex"},{default:t(()=>[l(A,{modelValue:o.sex,"onUpdate:modelValue":e[3]||(e[3]=a=>o.sex=a),placeholder:"请选择"},{default:t(()=>[l(U,{label:"男",value:"1"}),l(U,{label:"女",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(V,{span:12},{default:t(()=>[l(s,{label:"出生日期",prop:"birth"},{default:t(()=>[l(Y,{modelValue:o.birth,"onUpdate:modelValue":e[4]||(e[4]=a=>o.birth=a),type:"date",placeholder:"请输入",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(h,null,{default:t(()=>[l(s,{label:"地址",prop:"addr"},{default:t(()=>[l(p,{modelValue:o.addr,"onUpdate:modelValue":e[5]||(e[5]=a=>o.addr=a),placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1}),l(h,{style:{"justify-content":"flex-end"}},{default:t(()=>[l(s,null,{default:t(()=>[l(u,{type:"primary",onClick:W},{default:t(()=>e[11]||(e[11]=[_("取消")])),_:1,__:[11]}),l(u,{type:"primary",onClick:S},{default:t(()=>e[12]||(e[12]=[_("确定")])),_:1,__:[12]})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}},se=J(ae,[["__scopeId","data-v-e7965db4"]]);export{se as default};
